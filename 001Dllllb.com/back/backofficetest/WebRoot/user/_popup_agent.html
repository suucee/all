<div class="popup_dialog popup_agent" style="display: none;">
	<div class="mini-layout w600 sample-screen">
		<input type="hidden" name="id" value="0" />
		<table width="100%" class="table table-striped table-condensed">
			<thead>
				<tr>
					<th colspan="2"><h2 class="form_title">设置代理#<span class="id"></span></h2></th>
					<th style="text-align: right; font-size: 20px; padding: 10px;"><a
						href="javascript:void();" onclick="javascript:popupAgent.close();"><i class="icon-minus"></i> Close</a></th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td width="30%" class="field">姓名:</td>
					<td colspan="2"><span class="name"></span>
					</td>
				</tr>
				<tr>
					<td class="field">手机:</td>
					<td colspan="2" class="blue bold"><span class="mobile"></span>
					</td>
				</tr>
				<tr>
					<td class="field">Email:</td>
					<td colspan="2"><span class="email"></span></td>
				</tr>
				<tr>
					<td class="field">级别:</td>
					<td colspan="2">
					<select name="vipGrade">
					</select>
					</td>
				</tr>
				<!-- <tr>
					<td class="field">外汇内返:</td>
					<td colspan="2"><input /></td>
				</tr>
				<tr>
					<td class="field">金属内返:</td>
					<td colspan="2"><input /></td>
				</tr>
				<tr>
					<td class="field">原油内返:</td>
					<td colspan="2"><input /></td>
				</tr>-->
				<tr>
					<td class="field">操作密码:</td>
					<td colspan="2"><input type="password" name="operationPassword" /></td>
				</tr>
				<tr>
					<td colspan="3" style="text-align: center; padding: 10px;"><a
						href="javascript:void(0);"
						onclick="javascript:popupAgent.submit();"><span
							class="btn btn-primary"><span><i class="icon-plus icon-white"></i> 確認操作</span></span></a> &nbsp;&nbsp;&nbsp; <a
						href="javascript:void(0);"
						onclick="javascript:popupAgent.close();"><span
							class="btn btn-primary"><span><i class="icon-plus icon-white"></i> 取消操作</span></span></a></td>
				</tr>
			</tbody>
		</table>
	</div>
</div>
<script type="text/javascript">
$(document).ready(function(){
	$(".popup_agent [name='vipGrade']").load('_block_agents.html');
});

var popupAgent = {
	m_userId : 0,
	m_callbackFunc : null,
	open : function(userId, callbackFunc) {
		m_userId = userId;
		m_callbackFunc = callbackFunc;
		
		if (m_userId > 0) {
			$.jsonRPC.request('adminUserService.getOne', {
				params : [m_userId],
				success : function(result) {
					if (result) {
						$('.popup_agent .id').html(result.id);
						$('.popup_agent .name').html(result._name);
						$('.popup_agent .mobile').html(result.mobile);
						$('.popup_agent .email').html(result.email);
						$('.popup_agent [name="vipGrade"]').val(result.vipGrade);
						
						$('.popup_agent').fadeIn(200);
					}
				}
			});
		}
	},
	close : function() {
		$('.popup_agent').fadeOut(200);
	},
	submit : function() {
		if (m_userId > 0) {
			var vipGrade = $("[name='vipGrade']").val();
			var operationPassword = $("[name='operationPassword']").val();
			
			$.jsonRPC.request('adminAgentService.setAgent', {
				params : [m_userId, vipGrade, operationPassword],
				success : function(result) {
					window.alert("设置成功！");
					popupAgent.close();
					if (m_callbackFunc != null) {
						m_callbackFunc();
					}
				}
			});
		}
	}
};
</script>